## src/renderer/index.ts
```ts
// src/renderer/index.ts import './styles/main.css';import{SessionManager}from './services/session-manager';import{UIStateManager}from './services/ui-state';class WebSessionBrowser{private sessionManager: SessionManager;private uiState: UIStateManager;private pagesList: HTMLElement | null;private modal: HTMLElement | null;private startUrl: string = '';constructor(){console.log('WebSessionBrowser constructor started');this.sessionManager = new SessionManager();this.uiState = new UIStateManager();this.pagesList = document.getElementById('pages-list');this.modal = document.getElementById('session-modal');this.initializeEventListeners();console.log('WebSessionBrowser initialized');}private initializeEventListeners(): void{try{document.getElementById('start-url')?.addEventListener('keypress',(event)=>{if(event.key === 'Enter'){const url =(event.target as HTMLInputElement).value.trim();if(!url){//alert('Please enter a URL');return;}this.startUrl = url;if(this.modal)this.modal.style.display = 'block';document.getElementById('session-name')?.focus();}});// Session control buttons // Show modal when "New Session" is clicked document.getElementById('start-session')?.addEventListener('click',()=>{this.startUrl =(document.getElementById('start-url')as HTMLInputElement).value.trim();if(!this.startUrl){alert('Please enter a URL');return;}if(this.modal)this.modal.style.display = 'block';});// Handle modal save document.getElementById('save-session')?.addEventListener('click',()=> this.handleStartSession());// Handle modal cancel document.getElementById('cancel-session')?.addEventListener('click',()=>{if(this.modal)this.modal.style.display = 'none';});document.getElementById('end-session')?.addEventListener('click',()=> this.handleEndSession());// Close modal if clicking outside window.addEventListener('click',(event)=>{if(event.target === this.modal){if(this.modal)this.modal.style.display = 'none';}});// IPC event listeners window.electronAPI.onPageMetrics((data)=>{console.log('onPageMetrics started');try{if(this.sessionManager.getCurrentSession()){this.sessionManager.updateMetrics(data);this.updateProgress();}}catch(error){console.error('Error handling page metrics:',error);}});window.electronAPI.onPageNavigated((url)=>{console.log('onPageNavigated started');try{if(this.sessionManager.getCurrentSession()){this.sessionManager.addNewPage(url);this.updateProgress();}}catch(error){console.error('Error handling page navigation:',error);}});console.log('Event listeners initialized');}catch(error){console.error('Error initializing event listeners:',error);}}private async handleStartSession(): Promise<void>{try{console.log('handleStartSession(click)');const name =(document.getElementById('session-name')as HTMLInputElement).value.trim()|| 'test';const description =(document.getElementById('session-description')as HTMLTextAreaElement).value.trim()|| 'n/a';if(!name || !description){alert('Please fill in all fields');return;}console.log('Starting session with URL:',this.startUrl);await this.sessionManager.startSession(name,description,this.startUrl);this.uiState.updateControls(true);this.updateProgress();// Hide modal if(this.modal)this.modal.style.display = 'none';console.log('Session started successfully');}catch(error){console.error('Error starting session:',error);alert(`Failed to start session: ${(error as Error).message}`);}}private async handleEndSession(): Promise<void>{try{console.log('Ending session');await this.sessionManager.endSession();this.uiState.updateControls(false);if(this.pagesList)this.pagesList.innerHTML = '';console.log('Session ended successfully');}catch(error){console.error('Error ending session:',error);}}private updateProgress(): void{try{const session = this.sessionManager.getCurrentSession();if(!session || !this.pagesList)return;this.pagesList.innerHTML = session.pages .map(page => this.uiState.renderPage(page)).join('');}catch(error){console.error('Error updating progress display:',error);}}}// Initialize when DOM is ready document.addEventListener('DOMContentLoaded',()=>{try{console.log('Creating WebSessionBrowser instance');new WebSessionBrowser();}catch(error){console.error('Error creating WebSessionBrowser:',error);}});
```

## src/renderer/services/ui-state.ts
```ts
// src/renderer/services/ui-state.ts import{Page,SDKMetrics,XHRRequest}from '../../shared/types/session';export class UIStateManager{updateControls(sessionActive: boolean): void{const elements ={'session-name': sessionActive,'session-description': sessionActive,'start-url': sessionActive,'start-session': sessionActive,'end-session': !sessionActive};Object.entries(elements).forEach(([id,disabled])=>{const element = document.getElementById(id);if(element){(element as HTMLInputElement).disabled = disabled;}});}parseUrl(urlString: string):{domain: string;path: string;query: string}{try{const url = new URL(urlString);return{domain: url.hostname,path: url.pathname === '/' ? '' : url.pathname,query: url.search};}catch{return{domain: urlString,path: '',query: ''};}}renderSdks(sdks: SDKMetrics): string{return ` <div class="sdk-groups"> ${sdks.sdks.length > 0 ? ` <div class="sdk-group"> <div class="sdk-group-title">PayPal SDKs</div> ${sdks.sdks.map(sdk => ` <div class="sdk-entry"> <div class="sdk-name">${sdk.name}</div> ${sdk.version ? `<div class="sdk-version">v${sdk.version}</div>` : ''}</div> `).join('')}</div> ` : ''}${sdks.tracking.length > 0 ? ` <div class="sdk-group"> <div class="sdk-group-title">Analytics/Tracking</div> ${sdks.tracking.map(sdk => ` <div class="sdk-entry"> <div class="sdk-name">${sdk.name}</div> ${sdk.version ? `<div class="sdk-version">v${sdk.version}</div>` : ''}</div> `).join('')}</div> ` : ''}</div> `;}renderXhrRequests(requests: XHRRequest[]): string{return requests.map(xhr =>{const xhrUrlParts = this.parseUrl(xhr.url);return ` <details> <summary class="xhr-summary ${xhr.method === 'POST' ? 'post' : ''}"> <div class="xhr-method ${xhr.method === 'POST' ? 'post' : ''}">${xhr.method}</div> <div class="xhr-url"> <div class="domain">${xhrUrlParts.domain}</div> ${xhrUrlParts.path ? `<div class="path">${xhrUrlParts.path}</div>` : ''}${xhrUrlParts.query ? `<div class="query">${xhrUrlParts.query}</div>` : ''}</div> </summary> <div class="xhr-content"> <div>Status: ${xhr.status}</div> <div>Time: ${new Date(xhr.timestamp).toLocaleTimeString()}</div> <div>Duration: ${xhr.duration}ms</div> ${xhr.requestHeaders ? this.renderHeaders(xhr.requestHeaders): ''}${xhr.requestData ? this.renderRequestData(xhr.requestData): ''}${xhr.responseData ? this.renderResponseData(xhr.responseData): ''}</div> </details> `;}).join('');}private renderHeaders(headers: Record<string,string>): string{return ` <details class="headers-details"> <summary>Request Headers</summary> <div class="headers-content"> ${Object.entries(headers).map(([key,value])=> ` <div class="header-line"> <strong>${key}:</strong> ${value}</div> `).join('')}</div> </details> `;}private renderRequestData(data: string): string{return ` <details class="request-details"> <summary>POST Data</summary> <pre class="request-content">${this.formatData(data)}</pre> </details> `;}private renderResponseData(data: string): string{return ` <details class="response-details"> <summary>Response Data</summary> <pre class="response-content">${this.formatData(data)}</pre> </details> `;}formatData(data: string): string{try{if(data.includes('=')&& data.includes('&')){const params = new URLSearchParams(data);const formatted: Record<string,unknown> ={};params.forEach((value,key)=>{try{formatted[key]= JSON.parse(value);}catch{formatted[key]= value;}});return JSON.stringify(formatted,null,2);}try{const parsed = JSON.parse(data);return JSON.stringify(parsed,null,2);}catch{try{const decoded = atob(data);try{const parsed = JSON.parse(decoded);return JSON.stringify(parsed,null,2);}catch{return decoded;}}catch{return data;}}}catch{return data;}}renderPage(page: Page): string{const urlParts = this.parseUrl(page.url);const sdkCount = page.metrics.sdks.sdks.length + page.metrics.sdks.tracking.length;const xhrCount = page.metrics.xhrRequests.length;const scriptCount = page.metrics.resources.scripts.length;const imageCount = page.metrics.resources.images.length;return ` <div class="page-entry"> <div class="page-url"> <div class="domain"><strong>${urlParts.domain}</strong></div> ${urlParts.path ? `<div class="path">${urlParts.path}</div>` : ''}${urlParts.query ? `<div class="query">${urlParts.query}</div>` : ''}</div> <div class="page-timestamp">Visited: ${new Date(page.visitTime).toLocaleTimeString()}</div> ${sdkCount > 0 ? ` <details class="section-details" open> <summary>SDKs/APIs(${sdkCount})</summary> <div class="section-content"> ${this.renderSdks(page.metrics.sdks)}</div> </details> ` : ''}${xhrCount > 0 ? ` <details class="section-details"> <summary>Requests(${xhrCount})</summary> <div class="section-content"> ${this.renderXhrRequests(page.metrics.xhrRequests)}</div> </details> ` : ''}${scriptCount > 0 ? ` <details class="section-details"> <summary>Scripts(${scriptCount})</summary> <div class="section-content"> ${this.renderResources(page.metrics.resources.scripts)}</div> </details> ` : ''}${imageCount > 0 ? ` <details class="section-details"> <summary>Images(${imageCount})</summary> <div class="section-content"> ${this.renderResources(page.metrics.resources.images)}</div> </details> ` : ''}</div> `;}private renderResources(resources:{url: string}[]): string{return resources.map(resource =>{const urlParts = this.parseUrl(resource.url);return ` <div class="resource-entry"> <div class="domain">${urlParts.domain}</div> ${urlParts.path ? `<div class="path">${urlParts.path}</div>` : ''}${urlParts.query ? `<div class="query">${urlParts.query}</div>` : ''}</div> `;}).join('');}}
```

## src/renderer/services/session-manager.ts
```ts
// src/renderer/services/session-manager.ts import{Session,Page,XHRRequest,ResourceEntry,SDKEntry}from '../../shared/types/session';import{SDKIdentificationService}from './sdk-identification';export class SessionManager{private currentSession: Session | null = null;private sdkIdentifier: SDKIdentificationService;constructor(){console.log('SessionManager constructor');this.sdkIdentifier = new SDKIdentificationService();}async startSession(name: string,description: string,startUrl: string): Promise<void>{try{console.log('Starting new session:',{name,description,startUrl});this.currentSession ={id: Date.now(),name,description,startUrl,startTime: new Date().toISOString(),pages:[]};const result = await window.electronAPI.createWebContents(startUrl);if(result.error){console.error('Failed to create web contents:',result.error);this.currentSession = null;throw new Error(`Failed to load page: ${result.error}`);}// Remove this line - let the did-finish-load event trigger addNewPage // this.addNewPage(startUrl);console.log('Session started successfully');}catch(error){console.error('Error in startSession:',error);this.currentSession = null;throw error;}}addNewPage(url: string): void{try{console.log('addNewPage:',url);if(this.currentSession?.pages.some(page => page.url === url)){return;}const page: Page ={url,visitTime: new Date().toISOString(),metrics:{xhrRequests:[],resources:{scripts:[],images:[]},sdks:{sdks:[],tracking:[]}}};this.currentSession?.pages.push(page);}catch(error){console.error('Error adding new page:',error);}}updateMetrics(data: XHRRequest | ResourceEntry): void{try{console.log('updateMetrics');if(!this.currentSession)return;const currentPage = this.currentSession.pages[this.currentSession.pages.length - 1];if(!currentPage)return;if(data.type === 'xhr'){currentPage.metrics.xhrRequests.push(data);}else if(data.type === 'resource'){// Check if this resource is a known SDK const sdkInfo = this.sdkIdentifier.identifySDK(data.url);if(sdkInfo){const sdkEntry ={name: sdkInfo.name,version: sdkInfo.version,type: data.resourceType,timestamp: data.timestamp,url: data.url};if(sdkInfo.isTracking){if(!currentPage.metrics.sdks.tracking.some(s => s.url === data.url)){currentPage.metrics.sdks.tracking.push(sdkEntry);}}else{if(!currentPage.metrics.sdks.sdks.some(s => s.url === data.url)){currentPage.metrics.sdks.sdks.push(sdkEntry);}}}// Store as regular resource if(data.resourceType === 'script'){currentPage.metrics.resources.scripts.push(data);}else if(data.resourceType === 'img'){currentPage.metrics.resources.images.push(data);}}}catch(error){console.error('Error updating metrics:',error);}}async endSession(): Promise<void>{try{console.log('Ending session');if(!this.currentSession)return;await window.electronAPI.endSession();this.currentSession = null;}catch(error){console.error('Error ending session:',error);throw error;}}getCurrentSession(): Session | null{return this.currentSession;}}
```

## src/renderer/services/sdk-identification.ts
```ts
// src/renderer/services/sdk-identification.ts interface SDKPattern{regex: RegExp;params?: string[];versionGroup?: number;isTracking?: boolean;}interface SDKMatch{name: string;version?: string;isTracking: boolean;}export class SDKIdentificationService{private patterns: Record<string,SDKPattern> ={'PayPal JS SDK':{regex: /^https:\/\/www\.paypal\.com\/sdk\/js/,params:['client-id']},'PayPal Checkout.js':{regex: /^https:\/\/www\.paypal\.com\/sdk\/js/,params:['client-id','components=checkout']},'PayPal Buttons SDK':{regex: /^https:\/\/www\.paypal\.com\/sdk\/js/,params:['client-id','components=buttons']},'PayPal Messaging SDK':{regex: /^https:\/\/www\.paypal\.com\/sdk\/js/,params:['client-id','components=messages']},'PayPal Hosted Fields':{regex: /^https:\/\/www\.paypalobjects\.com\/web\/res\/[\w]+\/js\/hosted-fields\.js/},'Braintree JS SDK':{regex: /^https:\/\/js\.braintreegateway\.com\/web\/(\d+\.\d+\.\d+)\//,versionGroup: 1},'PayPal Tracking Pixel':{regex: /^https:\/\/t\.paypal\.com\/ts/,isTracking: true},'PayPal Analytics':{regex: /^https:\/\/www\.paypalobjects\.com\/webstatic\/r\/fb\/track\.js/,isTracking: true},'Google Analytics':{regex: /^https:\/\/www\.google-analytics\.com\/(analytics\.js|r\/collect|collect)/,isTracking: true}};identifySDK(url: string): SDKMatch | null{try{const parsedUrl = new URL(url);for(const[name,config]of Object.entries(this.patterns)){const match = config.regex.exec(url);if(match){// Check required URL parameters if specified if(config.params){const hasAllParams = config.params.every(param =>{if(param.includes('=')){const[key,value]= param.split('=');return parsedUrl.searchParams.get(key)=== value;}return parsedUrl.searchParams.has(param);});if(!hasAllParams)continue;}// Extract version if specified let version: string | undefined;if(config.versionGroup && match[config.versionGroup]){version = match[config.versionGroup];}return{name,version,isTracking: !!config.isTracking};}}return null;}catch(error){console.error('Error identifying SDK:',error);return null;}}}
```

## src/renderer/index.html
```html
<!DOCTYPE html> <html> <head> <title>PayPal Inspector</title> </head> <body> <!-- Session Modal --> <div id="session-modal" class="modal"> <div class="modal-content"> <h2>Session Information</h2> <div class="form-group"> <label for="session-name">Name:</label> <input type="text" id="session-name" placeholder="Session Name"> </div> <div class="form-group"> <label for="session-description">Description:</label> <textarea id="session-description" placeholder="Session Description" rows="2"></textarea> </div> <div class="modal-buttons"> <button id="save-session">Start Session</button> <button id="cancel-session">Cancel</button> </div> </div> </div> <!-- Main Browser Layout --> <div id="browser-controls"> <div class="url-bar"> <input type="url" id="start-url" placeholder="Enter URL"> <button id="end-session" disabled>End Session</button> </div> </div> <!-- Progress Panel --> <div id="progress-view"> <h3>Session Progress</h3> <div id="pages-list"></div> </div> </body> </html>
```

## src/renderer/styles/main.css
```css
/* src/renderer/styles/main.css */ body{margin: 0;height: 100vh;display: grid;grid-template-columns: 1fr 300px;grid-template-rows: auto 1fr;font-family: system-ui;overflow: hidden;}#browser-controls{grid-column: 1;grid-row: 1;padding: 10px;background: #f9f9f9;border-bottom: 1px solid #ddd;}.url-bar{display: flex;gap: 10px;align-items: center;padding: 8px;}#start-url{flex: 1;padding: 8px 12px;border: 1px solid #ddd;border-radius: 20px;/* More browser-like rounded corners */ font-size: 14px;outline: none;background: #f5f5f5;}#start-url:focus{background: white;border-color: #2563eb;/* PayPal blue when focused */ box-shadow: 0 0 0 2px rgba(37,99,235,0.1);/* Subtle focus ring */}#end-session{padding: 6px 12px;border-radius: 4px;border: none;background: #dc2626;/* Red for end session */ color: white;cursor: pointer;}#end-session:disabled{background: #d1d5db;cursor: not-allowed;}/* Modal Styles */ .modal{display: none;position: fixed;top: 0;left: 0;width: 100%;height: 100%;background-color: rgba(0,0,0,0.5);z-index: 1000;}.modal-content{position: relative;background-color: #fff;margin: 15% auto;padding: 20px;width: 50%;max-width: 500px;border-radius: 8px;box-shadow: 0 4px 6px rgba(0,0,0,0.1);}.modal h2{margin-top: 0;color: #333;}.form-group{margin-bottom: 15px;}.form-group label{display: block;margin-bottom: 5px;color: #666;}.form-group input,.form-group textarea{width: 100%;padding: 8px;border: 1px solid #ddd;border-radius: 4px;font-size: 14px;}.modal-buttons{display: flex;justify-content: flex-end;gap: 10px;margin-top: 20px;}/* Rest of your existing CSS styles... */ #progress-view{grid-column: 2;grid-row: 1 / span 2;padding: 20px;background: #f9f9f9;border-left: 1px solid #ddd;overflow-y: auto;}#session-controls{grid-column: 1;grid-row: 1;padding: 20px;background: #f9f9f9;}.controls-layout{background: white;padding: 15px;border-radius: 4px;box-shadow: 0 1px 3px rgba(0,0,0,0.1);display: flex;gap: 20px;}.inputs-section{flex: 1;}.buttons-container{flex: 0 0 auto;display: flex;flex-direction: column;gap: 10px;padding-left: 20px;}button{padding: 8px 16px;border-radius: 4px;border: none;background: #007bff;color: white;cursor: pointer;white-space: nowrap;width: 120px;/* Fixed width for buttons */}button:disabled{background: #cccccc;}.inputs-row{display: flex;gap: 40px;margin-top: 20px;}.name-input{flex: 35;}.description-input{flex: 65;}input,textarea{width: 100%;padding: 8px;border: 1px solid #ddd;border-radius: 4px;}textarea{resize: none;}.page-entry{padding: 15px;margin-bottom: 15px;background: white;border-radius: 4px;box-shadow: 0 1px 3px rgba(0,0,0,0.1);}.page-url{margin-bottom: 12px;padding-bottom: 8px;border-bottom: 1px solid #eee;}.page-url .domain{font-size: 16px;color: #000;word-break: break-word;}.page-url .path{font-size: 14px;color: #666;margin-top: 4px;word-break: break-word;}.page-url .query{font-size: 12px;color: #888;margin-top: 4px;word-break: break-word;font-family: monospace;}.page-timestamp{color: #666;font-size: 13px;margin-bottom: 4px;}.request-count{color: #0066cc;font-size: 13px;margin-bottom: 12px;}.xhr-summary{display: flex;align-items: flex-start;gap: 10px;}.xhr-method{font-family: monospace;font-size: 12px;color: #0066cc;white-space: nowrap;padding-top: 2px;}.xhr-url{flex: 1;}.xhr-url .domain{font-size: 14px;color: #000;word-break: break-word;}.xhr-url .path{font-size: 12px;color: #666;margin-top: 2px;word-break: break-word;}.xhr-url .query{font-size: 11px;color: #888;margin-top: 2px;word-break: break-word;font-family: monospace;}.xhr-details details{margin: 5px 0;padding: 8px;background: #f5f5f5;border-radius: 4px;}.xhr-content{padding: 10px;margin-top: 5px;}.xhr-content>div{margin: 5px 0;}.headers-details,.response-details{margin-top: 10px;background: #f8f8f8;padding: 8px;border-radius: 4px;}.headers-content{margin-top: 8px;}.header-line{font-family: monospace;margin: 4px 0;}.response-content{margin-top: 8px;white-space: pre-wrap;word-wrap: break-word;max-height: 300px;overflow-y: auto;background: #fff;padding: 8px;border-radius: 4px;font-family: monospace;font-size: 12px;}.payload-details{margin-top: 10px;background: #f8f8f8;padding: 8px;border-radius: 4px;}.payload-content{margin-top: 8px;white-space: pre-wrap;word-wrap: break-word;max-height: 300px;overflow-y: auto;background: #fff;padding: 8px;border-radius: 4px;font-family: monospace;font-size: 12px;}.xhr-method.post{color: #e34c26;/* Orange-red for POST */ font-weight: bold;}.xhr-summary.post{background-color: #fff8f6;/* Light orange background */}.request-details{margin-top: 10px;background: #f8f8f8;padding: 8px;border-radius: 4px;border-left: 3px solid #e34c26;/* Orange-red accent */}.request-content{margin-top: 8px;white-space: pre-wrap;word-wrap: break-word;max-height: 300px;overflow-y: auto;background: #fff;padding: 8px;border-radius: 4px;font-family: monospace;font-size: 12px;}.section-details{margin: 10px 0;background: #f5f5f5;border-radius: 4px;}.section-details summary{padding: 8px;cursor: pointer;font-weight: 500;}.section-content{padding: 10px;}.resource-entry{padding: 8px;margin: 5px 0;background: white;border-radius: 4px;}.resource-entry .domain{font-size: 14px;color: #000;word-break: break-word;}.resource-entry .path{font-size: 12px;color: #666;margin-top: 2px;word-break: break-word;}.resource-entry .query{font-size: 11px;color: #888;margin-top: 2px;word-break: break-word;font-family: monospace;}.sdk-groups{display: flex;flex-direction: column;gap: 15px;}.sdk-group{background: white;border-radius: 4px;padding: 10px;}.sdk-group-title{font-weight: 500;color: #666;margin-bottom: 8px;padding-bottom: 4px;border-bottom: 1px solid #eee;}.sdk-entry{padding: 6px;margin: 4px 0;}.sdk-name{color: #0066cc;font-weight: 500;}.sdk-version{color: #666;font-size: 0.9em;margin-top: 2px;}
```